<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>SeattleJS Conf Live Reactions</title>

    <link rel="stylesheet" href="dist/reset.css" />
    <link rel="stylesheet" href="dist/reveal.css" />
    <link rel="stylesheet" href="dist/theme/night.css" />
    <link rel="stylesheet" href="dist/custom.css" />

    <!-- Theme used for syntax highlighted code -->
    <link
      rel="stylesheet"
      href="plugin/highlight/tomorrow-night-bright.min.css"
    />
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <div class="split-view">
            <div>
              <video data-autoplay src="dist/media/reactions.mov" loop></video>
            </div>
            <div>
              <img src="dist/media/app.png" />
              <div>dub.sh/reactions</div>
            </div>
          </div>
        </section>

        <section>
          <h2>👋 Hello!</h2>
          <p>I'm @johnphamous</p>
          <p>lead design engineer @vercel</p>
        </section>

        <section>
          <div class="r-stack">
            <h2>I like to build stuff</h2>
          </div>
        </section>

        <section>
          <div class="r-stack">
            <video
              data-autoplay
              src="dist/media/power-picker.mp4"
              loop
              width="400px"
            ></video>
            <video
              data-autoplay
              src="dist/media/sticker.mp4"
              loop
              width="200px"
              style="z-index: 10; margin-left: 799px; margin-top: 357px"
            ></video>
            <video
              data-autoplay
              src="dist/media/ASCII Design Engineer.mp4"
              loop
              width="400px"
              style="margin-left: -52px; z-index: 10"
            ></video>
            <video
              data-autoplay
              src="dist/media/Instant Preview.mp4"
              loop
              muted
              width="400px"
              style="margin-top: 460px; margin-left: 360px"
            ></video>
            <video
              data-autoplay
              src="dist/media/CleanShot 2023-08-02 at 13.37.31.mp4"
              loop
              width="400px"
              style="margin-top: 0; margin-left: 300px"
            ></video>
            <video
              data-autoplay
              src="dist/media/yWyZdjGqNGOUhddz.mp4"
              loop
              muted
              width="400px"
              style="margin-left: -19px; margin-top: 0"
            ></video>
            <video
              data-autoplay
              src="dist/media/OoK7mvJBdnfNTv9l.mp4"
              loop
              muted
              width="300px"
              style="margin-left: 702px; margin-top: -18px"
            ></video>
            <video
              data-autoplay
              src="dist/media/dFdFyP5CvKanmdHf.mp4"
              loop
              muted
              width="400px"
              style="margin-right: 569px; margin-top: 409px"
            ></video>
            <video
              data-autoplay
              src="dist/media/CeWjFslmvRiIh1JO.mp4"
              loop
              muted
              width="300px"
              style="margin-left: 657px; margin-top: 480px"
            ></video>
          </div>
        </section>

        <section data-auto-animate>
          <h2 class="left">Let's build together</h2>
          <div class="r-hstack" style="align-items: start">
            <div class="left">
              <div>A component that is</div>
              <ul>
                <li>
                  <h2
                    data-id="multiplayer"
                    style="
                      font-size: 40px;
                      font-weight: 400;
                      font-family: 'Open Sans', sans-serif;
                    "
                  >
                    Multiplayer
                  </h2>
                </li>
                <li>Accessible</li>
                <li>Resilient</li>
              </ul>
            </div>
            <div style="width: 50%; margin-left: 64px">
              <video
                data-autoplay
                src="dist/media/reactions-lots.mp4"
                loop
              ></video>
            </div>
          </div>
          <aside class="notes">
            Ship, wanted keynote to be engaging and interactive
          </aside>
        </section>

        <section data-auto-animate>
          <h2 class="left" data-id="multiplayer">Multiplayer</h2>
          <div class="r-hstack" style="align-items: start">
            <div class="left">
              <div data-id="0">This use to be hard</div>
              <ul>
                <li>Learning sockets</li>
                <li>Scaling servers</li>
                <li>Client state</li>
                <li>Conflict resolution</li>
                <li>Unknown unknowns</li>
              </ul>
            </div>
            <div style="width: 50%; margin-left: 64px">
              <video
                data-autoplay
                src="dist/media/reactions-lots.mp4"
                loop
              ></video>
            </div>
          </div>
        </section>

        <section data-auto-animate>
          <h2 class="left">It's easy now</h2>
          <div class="r-hstack" style="align-items: start">
            <div class="left">
              <div data-id="0" style="opacity: 0.2">This use to be hard</div>
              <ul>
                <li><s>Learning sockets</s></li>
                <li><s>Scaling servers</s></li>
                <li><s>Client state</s></li>
                <li><s>Conflict resolution</s></li>
                <li><s>Unknown unknowns</s></li>
              </ul>
            </div>
            <div style="width: 50%; margin-left: 64px">
              <video data-autoplay src="dist/media/liveblocks.mp4" loop></video>
            </div>
          </div>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim class="language-javascript" data-line-numbers>
const REACTIONS = [
  { label: "fire", display: "🔥" },
  { label: "heart", display: "❤️" },
  { label: "octopus", display: "🐙" },
  { label: "mountain", display: "🏔️" },
];
		</code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-javascript javascript" data-line-numbers>
		<script type="text/template">
const REACTIONS = [
  { label: "fire", display: "🔥" },
  { label: "heart", display: "❤️" },
  { label: "octopus", display: "🐙" },
  { label: "mountain", display: "🏔️" },
];

export default function Reactions() {
  return (
    <aside
      className="flex items-center justify-center w-full h-full gap-2 text-4xl"
      role="group"
      aria-label="Live stream reactions"
    >
      {REACTIONS.map(({ display, label }) => {
        return (
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="w-10 h-10"
          >
            {display}
          </button>
        ))}
    </aside>
  );
}
		</script>
		</code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-javascript javascript"  data-line-numbers="1-6|10-14|15-24">

		<script type="text/template">
const REACTIONS = [
  { label: "fire", display: "🔥" },
  { label: "heart", display: "❤️" },
  { label: "octopus", display: "🐙" },
  { label: "mountain", display: "🏔️" },
];

export default function Reactions() {
  return (
    <aside
      className="flex items-center justify-center w-full h-full gap-2 text-4xl"
      role="group"
      aria-label="Live stream reactions"
    >
      {REACTIONS.map(({ display, label }) => {
        return (
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="w-10 h-10"
          >
            {display}
          </button>
        ))}
    </aside>
  );
}
</script>
		</code></pre>
        </section>

        <section>
          <iframe
            data-src="https://live-reactions-one.vercel.app/1"
            data-preload
          ></iframe>
          <aside class="notes">
            Keyboard test, lets hook up the buttons now
          </aside>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-javascript javascript"  data-line-numbers="2|20-25|28-37|28|29-31|32-36">

		<script type="text/template">
export default function Reactions() {
  const [allReactions, setAllReactions] = useState([]);

  return (
    <aside
      className="flex items-center justify-center w-full h-full gap-2 text-4xl"
      role="group"
      aria-label="Live stream reactions"
    >
      {REACTIONS.map(({ display, label }) => {
        const reactions = allReactions.filter(
          (reaction) => reaction.label === label
        );

        return (
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="w-10 h-10"
            onClick={() => {
              setAllReactions((prev) => [
                ...prev,
                { id: generateRandomId(), label },
              ]);
            }}
          >
            {display}
            <div aria-live="polite" role="log" aria-atomic>
              <div className="sr-only">
                {reactions.length} {label} reactions
              </div>
              <div aria-hidden>
                {reactions.map((reaction) => {
                  return <div key={reaction.id}>{display}</div>;
                })}
              </div>
            </div>
          </button>
        );
      })}
    </aside>
  );
}
</script>
		</code></pre>
          <aside class="notes">
            aria-live, role, aria-atomic makes it better for ATs.
          </aside>
        </section>

        <section>
          <iframe
            class="iframe"
            data-src="https://live-reactions-one.vercel.app/2"
            data-preload
          ></iframe>
          <aside class="notes">keyboard, voiceover</aside>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-javascript javascript"  data-line-numbers="1-2|7-18|42">

		<script type="text/template">
/** In milliseconds. */
const ANIMATION_DURATION = 2000;

export default function Reactions() {
  const [allReactions, setAllReactions] = useState([]);

  // Remove stale reactions.
  useInterval(() => {
    const now = new Date().getTime();

    setAllReactions((reactions) =>
      reactions.filter((reaction) => {
        const timePassed = now - reaction.timestamp;

        return timePassed < ANIMATION_DURATION;
      })
    );
  }, ANIMATION_DURATION);

  return (
    <aside
      className="flex items-center justify-center w-full h-full gap-2 text-4xl"
      role="group"
      aria-label="Live stream reactions"
    >
      {REACTIONS.map(({ display, label }) => {
        const reactions = allReactions.filter(
          (reaction) => reaction.label === label
        );

        return (
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="w-10 h-10"
            onClick={() => {
              setAllReactions((prev) => [
                ...prev,
                {
                  id: generateRandomId(),
                  label,
                  timestamp: new Date().getTime(),
                },
              ]);
            }}
          >
            {display}
            <div aria-live="polite" role="log" aria-atomic>
              <div className="sr-only">
                {reactions.length} {label} reactions
              </div>
              <div aria-hidden>
                {reactions.map((reaction) => {
</script>
		</code></pre>
        </section>

        <section>
          <iframe
            class="iframe"
            data-src="https://live-reactions-one.vercel.app/3"
            data-preload
          ></iframe>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape data-line-numbers>
module.exports = {
  theme: {
    extend: {
    },
  },
};
		</code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape data-line-numbers>
module.exports = {
  theme: {
    extend: {
      animation: {
        reaction: "travel 2s ease-in-out 1 forwards",
      },
      keyframes: {
        travel: {
          "0%": {
            transform: "translate(0, -50px)",
            rotate: "0",
            scale: "0",
            opacity: "0",
          },
          "5%": {
            scale: "0.1",
            opacity: "0.2",
          },
          "40%": {
            opacity: "1",
            scale: "0.3",
          },
          "60%": {
            opacity: "1",
          },
          "100%": {
            transform: "translate(0, -80px)",
            scale: "1.5",
            opacity: "0",
          },
        },
      },
    },
  },
};
		</code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape data-line-numbers="4-6|9-14|15-22|23-30">
module.exports = {
  theme: {
    extend: {
      animation: {
        reaction: "travel 2s ease-in-out 1 forwards",
      },
      keyframes: {
        travel: {
          "0%": {
            transform: "translate(0, -50px)",
            rotate: "0",
            scale: "0",
            opacity: "0",
          },
          "5%": {
            scale: "0.1",
            opacity: "0.2",
          },
          "40%": {
            opacity: "1",
            scale: "0.3",
          },
          "60%": {
            opacity: "1",
          },
          "100%": {
            transform: "translate(0, -80px)",
            scale: "1.5",
            opacity: "0",
          },
        },
      },
    },
  },
};
		</code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-javascript javascript"  data-line-numbers>

		      <script type="text/template">
<div aria-hidden>
  {reactions.map((reaction) => {
    return (
      <div
        key={reaction.id}
      >
        {display}
      </div>
    );
  })}
</div>
		      </script>
		      </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-javascript javascript"  data-line-numbers="6">

		      <script type="text/template">
<div aria-hidden>
  {reactions.map((reaction) => {
    return (
      <div
        key={reaction.id}
        className="animate-reaction"
      >
        {display}
      </div>
    );
  })}
</div>
		      </script>
		      </code></pre>
        </section>

        <section>
          <iframe
            class="iframe"
            data-src="https://live-reactions-one.vercel.app/4"
            data-preload
          ></iframe>
          <aside class="notes">doesn't look natural, let's fix that</aside>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-javascript javascript"  data-line-numbers>

			    <script type="text/template">
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="relative w-10 h-10"
            onClick={() => {
              setAllReactions((prev) => [
                ...prev,
                {
                  id: generateRandomId(),
                  label,
                  timestamp: new Date().getTime(),
                },
              ]);
            }}
          >
          </button>
			    </script>
			    </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-javascript javascript"  data-line-numbers="|12-13">

			    <script type="text/template">
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="relative w-10 h-10"
            onClick={() => {
              setAllReactions((prev) => [
                ...prev,
                {
                  id: generateRandomId(),
                  label,
                  timestamp: new Date().getTime(),
                  curve: getRandomAnimationCurve(),
                  startingAngle: getRandomAngle()
                },
              ]);
            }}
          >
          </button>
			    </script>
			    </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-3"
          ><code data-trim data-noescape class="language-javascript javascript"  data-line-numbers="|1-6|8-15">

			    <script type="text/template">
export const getRandomAnimationCurve = () => {
  const randomX2 = `${Math.random() * 5}%`;
  const randomY2 = `${Math.random() * 50 + 50}%`;

  return `cubic-bezier(100%, 100%, ${randomX2}, ${randomY2})`;
};

export const getRandomAngle = () => {
  // Decide on whether the reaction is facing left or right.
  const direction = Math.random() < 0.5 ? 1 : -1;
  // Decide the starting angle of the reaction.
  const startingAngle = Math.floor(Math.random() * 90);

  return direction * startingAngle;
};
			    </script>
			    </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-javascript javascript"  data-line-numbers>

			    <script type="text/template">
              <div aria-hidden className="absolute inset-0">
                {reactions.map((reaction) => {
                  return (
                    <div
                      key={reaction.id}
                      className="absolute animate-reaction"
                    >
                      {display}
                    </div>
                  );
                })}
              </div>
			    </script>
			    </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-javascript javascript"  data-line-numbers="7-10">

			    <script type="text/template">
              <div aria-hidden className="absolute inset-0">
                {reactions.map((reaction) => {
                  return (
                    <div
                      key={reaction.id}
                      className="absolute animate-reaction"
                      style={{
                        // Sets transform: rotate();
                        "--starting-angle": `${reaction.startingAngle}deg`,
                        animationTimingFunction: reaction.curve,
                      }}
                    >
                      {display}
                    </div>
                  );
                })}
              </div>
			    </script>
			    </code></pre>
        </section>

        <section>
          <iframe
            class="iframe"
            data-src="https://live-reactions-one.vercel.app/5"
            data-preload
          ></iframe>
        </section>

        <section data-auto-animate>
          <h2>Installing Liveblocks</h2>
          <pre
            data-id="code-animation"
          ><code data-trim data-noescape class="language-bash bash">

			    <script type="text/template">
npm install @liveblocks/client @liveblocks/react
			    </script>
			    </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape class="language-javascript javascript" data-line-numbers="1-6|8-14|10-12">

			    <script type="text/template">
import { createClient } from "@liveblocks/client";
import { RoomProvider } from "@/liveblocks.config";

const client = createClient({
  publicApiKey: process.env.NEXT_PUBLIC_LIVEBLOCKS_PUBLIC_KEY,
});

export default function Reactions() {
  return (
    <RoomProvider id="seattlejs-conf">
      // Rest of app
    </RoomProvider>
  )
}
			    </script>
			    </code></pre>
        </section>

        <section>
          <iframe
            class="iframe"
            data-src="https://live-reactions-one.vercel.app/5"
            data-preload
          ></iframe>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape class="language-javascript javascript" data-line-numbers>

				  <script type="text/template">
const Reactions = () => {
  const [allReactions, setAllReactions] = useState([]);
  // rest of component
}
				  </script>
				  </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape class="language-javascript javascript" data-line-numbers="1,5">

				  <script type="text/template">
import { useBroadcastEvent } from "@/liveblocks.config";

const Reactions = () => {
  const [allReactions, setAllReactions] = useState([]);
  const broadcast = useBroadcastEvent();
  // rest of component
}
				  </script>
				  </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape class="language-javascript javascript" data-line-numbers="|19-34|23-34">

				  <script type="text/template">
import { useBroadcastEvent } from "@/liveblocks.config";

const Reactions = () => {
  const [allReactions, setAllReactions] = useState([]);
  const broadcast = useBroadcastEvent();

  return (
    <aside
      className="flex items-center justify-center w-full h-full gap-2 text-4xl"
      role="group"
      aria-label="Live stream reactions"
    >
      {REACTIONS.map(({ display, label }) => {
        const reactions = allReactions.filter(
          (reaction) => reaction.label === label
        );

        return (
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="relative w-10 h-10"
            onClick={() => {
              setAllReactions((prev) => [
                ...prev,
                {
                  id: generateRandomId(),
                  label,
                  timestamp: new Date().getTime(),
                  curve: getRandomAnimationCurve(),
                  startingAngle: getRandomAngle(),
                },
              ]);
            }}
          >
	    {/* rest of component */}
	  </button>
        )
    </aside>
  );
}
				  </script>
				  </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape class="language-javascript javascript" data-line-numbers="23-37|24-30|32|33-36">

				  <script type="text/template">
import { useBroadcastEvent } from "@/liveblocks.config";

const Reactions = () => {
  const [allReactions, setAllReactions] = useState([]);
  const broadcast = useBroadcastEvent();

  return (
    <aside
      className="flex items-center justify-center w-full h-full gap-2 text-4xl"
      role="group"
      aria-label="Live stream reactions"
    >
      {REACTIONS.map(({ display, label }) => {
        const reactions = allReactions.filter(
          (reaction) => reaction.label === label
        );

        return (
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="relative w-10 h-10"
            onClick={() => {
              const newReaction = {
                id: generateRandomId(),
                label,
                timestamp: new Date().getTime(),
                curve: getRandomAnimationCurve(),
                startingAngle: getRandomAngle(),
              };

              setAllReactions((prev) => [...prev, newReaction]);
              broadcast({
                type: "reaction",
                emoji: label,
              });
            }}
          >
	    {/* rest of component */}
	  </button>
        );
      })}
    </aside>
  );
};
				  </script>
				  </code></pre>
        </section>

        <section>
          <iframe
            class="iframe"
            data-src="https://live-reactions-one.vercel.app/6"
            data-preload
          ></iframe>
          <aside class="notes">network inspector websockets</aside>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape class="language-javascript javascript" data-line-numbers>

				  <script type="text/template">
import { useBroadcastEvent } from "@/liveblocks.config";

const Reactions = () => {
  const [allReactions, setAllReactions] = useState([]);
  const broadcast = useBroadcastEvent();

  // Remove stale reactions.
  useInterval(() => {
    const now = new Date().getTime();

    setAllReactions((reactions) =>
      reactions.filter((reaction) => {
        const timePassed = now - reaction.timestamp;

        return timePassed < ANIMATION_DURATION;
      })
    );
  }, ANIMATION_DURATION);

  return (
    <aside
      className="flex items-center justify-center w-full h-full gap-2 text-4xl"
      role="group"
      aria-label="Live stream reactions"
    >
      {REACTIONS.map(({ display, label }) => {
        const reactions = allReactions.filter(
          (reaction) => reaction.label === label
        );

        return (
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="relative w-10 h-10"
            onClick={() => {
              const newReaction = {
                id: generateRandomId(),
                label,
                timestamp: new Date().getTime(),
                curve: getRandomAnimationCurve(),
                startingAngle: getRandomAngle(),
              };

              setAllReactions((prev) => [...prev, newReaction]);
              broadcast({
                type: "reaction",
                emoji: label,
              });
            }}
          >
            <span className="relative z-10">{display}</span>
            <div aria-live="polite" role="log" aria-atomic>
              <div className="sr-only">
                {reactions.length} {label} reactions
              </div>
              <div aria-hidden className="absolute inset-0">
                {reactions.map((reaction) => {
                  return (
                    <div
                      key={reaction.id}
                      className={`absolute animate-reaction`}
                      style={{
                        // Sets transform: rotate();
                        "--starting-angle": `${reaction.startingAngle}deg`,
                        animationTimingFunction: reaction.curve,
                      }}
                    >
                      {display}
                    </div>
                  );
                })}
              </div>
            </div>
          </button>
        );
      })}
    </aside>
  );
};
				  </script>
				  </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape class="language-javascript javascript" data-line-numbers="1,5,8-19|5,8-19">

				  <script type="text/template">
import { useBroadcastEvent, useEventListener } from "@/liveblocks.config";

const Reactions = () => {
  const [allReactions, setAllReactions] = useState([]);
  const [allRemoteReactions, setAllRemoteReactions] = useState([]);
  const broadcast = useBroadcastEvent();

  useEventListener(({ event }) => {
    setAllRemoteReactions((prev) => [
      ...prev,
      {
        id: generateRandomId(),
        label: event.emoji,
        timestamp: new Date().getTime(),
        curve: getRandomAnimationCurve(),
        startingAngle: getRandomAngle(),
      },
    ]);
  });

  // Remove stale reactions.
  useInterval(() => {
    const now = new Date().getTime();

    setAllReactions((reactions) =>
      reactions.filter((reaction) => {
        const timePassed = now - reaction.timestamp;

        return timePassed < ANIMATION_DURATION;
      })
    );
  }, ANIMATION_DURATION);

  return (
    <aside
      className="flex items-center justify-center w-full h-full gap-2 text-4xl"
      role="group"
      aria-label="Live stream reactions"
    >
      {REACTIONS.map(({ display, label }) => {
        const reactions = allReactions.filter(
          (reaction) => reaction.label === label
        );

        return (
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="relative w-10 h-10"
            onClick={() => {
              const newReaction = {
                id: generateRandomId(),
                label,
                timestamp: new Date().getTime(),
                curve: getRandomAnimationCurve(),
                startingAngle: getRandomAngle(),
              };

              setAllReactions((prev) => [...prev, newReaction]);
              broadcast({
                type: "reaction",
                emoji: label,
              });
            }}
          >
            <span className="relative z-10">{display}</span>
            <div aria-live="polite" role="log" aria-atomic>
              <div className="sr-only">
                {reactions.length} {label} reactions
              </div>
              <div aria-hidden className="absolute inset-0">
                {reactions.map((reaction) => {
                  return (
                    <div
                      key={reaction.id}
                      className={`absolute animate-reaction`}
                      style={{
                        // Sets transform: rotate();
                        "--starting-angle": `${reaction.startingAngle}deg`,
                        animationTimingFunction: reaction.curve,
                      }}
                    >
                      {display}
                    </div>
                  );
                })}
              </div>
            </div>
          </button>
        );
      })}
    </aside>
  );
};
				  </script>
				  </code></pre>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape class="language-javascript javascript" data-line-numbers="4|4-5">

				  <script type="text/template">
import { useBroadcastEvent, useEventListener } from "@/liveblocks.config";

const Reactions = () => {
  const [allLocalReactions, setAllLocalReactions] = useState([]);
  const [allRemoteReactions, setAllRemoteReactions] = useState([]);
  const broadcast = useBroadcastEvent();

  useEventListener(({ event }) => {
    setAllRemoteReactions((prev) => [
      ...prev,
      {
        id: generateRandomId(),
        label: event.emoji,
        timestamp: new Date().getTime(),
        curve: getRandomAnimationCurve(),
        startingAngle: getRandomAngle(),
      },
    ]);
  });

  // Remove stale reactions.
  useInterval(() => {
    const now = new Date().getTime();

    setAllLocalReactions((reactions) =>
      reactions.filter((reaction) => {
        const timePassed = now - reaction.timestamp;

        return timePassed < ANIMATION_DURATION;
      })
    );
  }, ANIMATION_DURATION);

  return (
    <aside
      className="flex items-center justify-center w-full h-full gap-2 text-4xl"
      role="group"
      aria-label="Live stream reactions"
    >
      {REACTIONS.map(({ display, label }) => {
        const reactions = allLocalReactions.filter(
          (reaction) => reaction.label === label
        );

        return (
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="relative w-10 h-10"
            onClick={() => {
              const newReaction = {
                id: generateRandomId(),
                label,
                timestamp: new Date().getTime(),
                curve: getRandomAnimationCurve(),
                startingAngle: getRandomAngle(),
              };

              setAllLocalReactions((prev) => [...prev, newReaction]);
              broadcast({
                type: "reaction",
                emoji: label,
              });
            }}
          >
            <span className="relative z-10">{display}</span>
            <div aria-live="polite" role="log" aria-atomic>
              <div className="sr-only">
                {reactions.length} {label} reactions
              </div>
              <div aria-hidden className="absolute inset-0">
                {reactions.map((reaction) => {
                  return (
                    <div
                      key={reaction.id}
                      className={`absolute animate-reaction`}
                      style={{
                        // Sets transform: rotate();
                        "--starting-angle": `${reaction.startingAngle}deg`,
                        animationTimingFunction: reaction.curve,
                      }}
                    >
                      {display}
                    </div>
                  );
                })}
              </div>
            </div>
          </button>
        );
      })}
    </aside>
  );
};
				  </script>
				  </code></pre>
        </section>

        <section>
          <div class="split-view">
            <iframe
              class="iframe"
              data-src="https://live-reactions-one.vercel.app/6"
              data-preload
            ></iframe>
            <iframe
              class="iframe"
              data-src="https://live-reactions-one.vercel.app/6"
              data-preload
            ></iframe>
          </div>
        </section>

        <section data-auto-animate>
          <pre
            data-id="code-animation-2"
          ><code data-trim data-noescape class="language-javascript javascript" data-line-numbers="43-448|73-75|77|21-34">

				  <script type="text/template">
import { useBroadcastEvent, useEventListener } from "@/liveblocks.config";

const Reactions = () => {
  const [allLocalReactions, setAllLocalReactions] = useState([]);
  const [allRemoteReactions, setAllRemoteReactions] = useState([]);
  const broadcast = useBroadcastEvent();

  useEventListener(({ event }) => {
    setAllRemoteReactions((prev) => [
      ...prev,
      {
        id: generateRandomId(),
        label: event.emoji,
        timestamp: new Date().getTime(),
        curve: getRandomAnimationCurve(),
        startingAngle: getRandomAngle(),
      },
    ]);
  });

  // Remove stale reactions.
  useInterval(() => {
    const now = new Date().getTime();

    const cleanup = (reactions) =>
      reactions.filter((reaction) => {
        const timePassed = now - reaction.timestamp;

        return timePassed < ANIMATION_DURATION;
      });

    setAllLocalReactions(cleanup);
    setAllRemoteReactions(cleanup);
  }, ANIMATION_DURATION);

  return (
    <aside
      className="flex items-center justify-center w-full h-full gap-2 text-4xl"
      role="group"
      aria-label="Live stream reactions"
    >
      {REACTIONS.map(({ display, label }) => {
        const localReactions = allLocalReactions.filter(
          (reaction) => reaction.label === label
        );
        const remoteReactions = allRemoteReactions.filter(
          (reaction) => reaction.label === label
        );

        return (
          <button
            key={label}
            aria-label={`${label} reaction`}
            className="relative w-10 h-10"
            onClick={() => {
              const newReaction = {
                id: generateRandomId(),
                label,
                timestamp: new Date().getTime(),
                curve: getRandomAnimationCurve(),
                startingAngle: getRandomAngle(),
              };

              setAllLocalReactions((prev) => [...prev, newReaction]);
              broadcast({
                type: "reaction",
                emoji: label,
              });
            }}
          >
            <span className="relative z-10">{display}</span>
            <div aria-live="polite" role="log" aria-atomic>
              <div className="sr-only">
                {localReactions.length + remoteReactions.length} {label} reactions
              </div>
              <div aria-hidden className="absolute inset-0">
                {[...localReactions, ...remoteReactions].map((reaction) => {
                  return (
                    <div
                      key={reaction.id}
                      className={`absolute animate-reaction`}
                      style={{
                        // Sets transform: rotate();
                        "--starting-angle": `${reaction.startingAngle}deg`,
                        animationTimingFunction: reaction.curve,
                      }}
                    >
                      {display}
                    </div>
                  );
                })}
              </div>
            </div>
          </button>
        );
      })}
    </aside>
  );
};
				  </script>
				  </code></pre>
        </section>

        <section>
          <div class="split-view">
            <iframe
              class="iframe"
              data-src="https://live-reactions-one.vercel.app/7"
              data-preload
            ></iframe>
            <iframe
              class="iframe"
              data-src="https://live-reactions-one.vercel.app/7"
              data-preload
            ></iframe>
            <aside class="notes">Test with keyboard</aside>
          </div>
        </section>

        <section>
          <div class="grid-view">
            <iframe
              class="iframe"
              data-src="https://live-reactions-one.vercel.app/7"
              data-preload
            ></iframe>
            <iframe
              class="iframe"
              data-src="https://live-reactions-one.vercel.app/7"
              data-preload
            ></iframe>
            <iframe
              class="iframe"
              data-src="https://live-reactions-one.vercel.app/7"
              data-preload
            ></iframe>
            <iframe
              class="iframe"
              data-src="https://live-reactions-one.vercel.app/7"
              data-preload
            ></iframe>
            <aside class="notes">Test with keyboard</aside>
          </div>
        </section>

        <section>
          <h2>Done!</h2>
          <div class="final-split-view">
            <video data-autoplay src="dist/media/ship.mp4" loop></video>
            <iframe
              class="iframe"
              data-src="https://www.expensive.toys/toys/reactions"
              data-preload
            ></iframe>
            <img src="dist/media/artur.png" alt="" class="artur" />
          </div>
        </section>

        <section>
          <h2>Links</h2>
          <div class="links">
            <div>
              <img src="/dist/media/slides.jpg" alt="" />
              <div>Slides</div>
            </div>
            <div>
              <img src="/dist/media/github.jpg" alt="" />
              <div>GitHub Repo</div>
            </div>
            <div>
              <img src="/dist/media/x.jpg" alt="" />
              <div>X</div>
            </div>
          </div>
          <div class="emoji-stats">
            <div id="fire-stat"></div>
            <div id="heart-stat"></div>
            <div id="octopus-stat"></div>
            <div id="clap-stat"></div>
          </div>
        </section>
      </div>
    </div>

    <div id="reactions-container"></div>

    <script src="dist/reveal.js"></script>
    <script src="dist/liveblocks.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        hash: true,
        autoPlayMedia: true,
        highlight: {
          beforeHighlight: (hljs) => {
            hljs.configure({
              languages: ["javascript", "bash"],
              ignoreUnescapedHTML: false,
            });
          },
        },
        preloadIframes: true,
        transition: "fade",
        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
      });
    </script>
  </body>
</html>
